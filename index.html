<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://kit.fontawesome.com/ade78b387f.js" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet" />
  <script class="jsbin" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <link rel="icon" type="image/png" href="images/balloon.png" />
  <link rel="stylesheet" href="style.css">
  <script src="main.js" defer></script>
  <title>별풍력 테스트</title>

</head>

<body>
  <!-- navbar -->
  <nav id="navbar">
    <div class="navbar__title">
      <span class="navbar__title__logo">

        <h1 id="logo" style="color:#fe918d;"><i class=" fas fa-star"></i>별풍력 테스트</h1>
      </span>
      <h2>인공지능이 말해주는 내 별풍력</h2>
    </div>
  </nav>

  <!-- toogle -->
  <section id="gender">
    <span id="gender1" style="display:block;"> 여 <i class="fas fa-venus"></i></span>

    <span id="gender2" style="display:none; "> 남 <i class="fas fa-mars"></i></span>
    <div class="Content__gender"><input type="checkbox" class="switch_1" onclick="gender();"></div>
  </section>

  <div class="file-upload" id="girl" style="display: block;">
    <div class="image-upload-wrap">
      <input class="file-upload-input" type='file' onchange="readURL(this);" accept="image/*" />
      <div class="drag-text">
        <i class="fas fa-image fa-3x"></i>
        <h2>(사진 첨부)</h2>
        <h3>당신의 별풍력을 테스트해보세요!</h3>
      </div>
    </div>
    <div class=" file-upload-content">
      <img class="file-upload-image" id="face-id" src="#" alt="your image" />
      <div class="container">
        <i class="fas fa-spinner fa-2x fa-spin"></i>
      </div>
    </div>
  </div>

  <div class="file-upload" id="boy" style="display: none;">
    <div class="image-upload-wrap">
      <input class="file-upload-input" type='file' onchange="readURL(this);" accept="image/*" />
      <div class="drag-text">
        <i class="fas fa-image fa-3x"></i>
        <h2>(사진 첨부)</h2>
        <h3>당신의 별풍력을 테스트해보세요!</h3>
      </div>
    </div>
    <div class=" file-upload-content">
      <img class="file-upload-image" id="face-id" src="#" alt="your image" />
      <div class="container">
        <i class="fas fa-spinner fa-2x fa-spin"></i>
      </div>
    </div>
  </div>
  <div class="main">
    <div class="result-message1"></div>
    <div class="result-message2"></div>
    <div class="result-message3"></div>
    <div class="result-message4"></div>
    <div class="result-message5"></div>
    <div class="resultmessagesub"></div>
    <div class="result-detail"></div>
    <div id="label-container"></div>
    <div class="image-title-wrap" style="display: none;">
      <button type="button" onclick="removeUpload()" class="remove-image">다시 해보기</button>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js">
  </script>

  <script type="text/javascript">
    // More API functions here:
    // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image

    // the link to your model provided by Teachable Machine export panel

    const URL = "https://teachablemachine.withgoogle.com/models/RUAmcQEsS/";



    let model, webcam, labelContainer, maxPredictions;

    // Load the image model and setup the webcam
    async function init() {
      const modelURL = URL + "model.json";
      const metadataURL = URL + "metadata.json";

      // load the model and metadata
      // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
      // or files from your local hard drive
      // Note: the pose library adds "tmImage" object to your window (window.tmImage)
      model = await tmImage.load(modelURL, metadataURL);
      maxPredictions = model.getTotalClasses();

      // Convenience function to setup a webcam


      labelContainer = document.getElementById("label-container");
      for (let i = 0; i < maxPredictions; i++) { // and class labels
        labelContainer.appendChild(document.createElement("div"));
      }
    }

    // run the webcam image through the image model
    async function predict() {
      // predict can take in an image, video or canvas html element
      var image = document.getElementById("face-id")
      const prediction = await model.predict(image);
      prediction.sort((a, b) => parseFloat(b.probability) - parseFloat(a.probability));
      var resultMessage1;
      var resultDetail;
      var resultMessageSub;
      switch (prediction[0].className) {
        case "월1억":
          resultMessage1 = "축하합니다!! 당신은 한달에 100만개의 별풍선을 받을 수 있습니다.(1억!)"
          resultMessageSub = "(지금 당장 도전하세요!)"
          resultDetail = "나와 같은 별풍력을 가진 BJ : 엘린, 박가린, 커멘더지코, 금화 등"
          break;
        case "월5천":
          resultMessage2 = "당신은 한달에 50만개 이상의 별풍선을 받을 수 있습니다.(5천만원!)"
          resultMessageSub = "(지금도 늦지 않았습니다)"
          resultDetail = "나와 같은 별풍력을 가진 BJ : 문월, 재희, 쁠리, 팡이, 아윤, 김시원 등"
          break;
        case "월3천":
          resultMessage3 = "당신은 한달에 30만개 이상의 별풍선을 받을 수 있습니다.(3천만원!)"
          resultMessageSub = "(도전하세요!)"
          resultDetail = "나와 같은 별풍력을 가진 BJ : 와꾸대장봉준, 도아, 최군 등"
          break;
        case "월천":
          resultMessage4 = "당신은 한달에 10만개 이상의 별풍선을 받을 수 있습니다."
          resultMessageSub = "(먹고 사는데 이정도면 충분하죠?)"
          resultDetail = "나와 같은 별풍력을 가진 BJ : 오메킴, 파퀴, 코트, 짭구, 에디린 등"
          break;
        case "천이하":
          resultMessage5 = "당신은 일반인 입니다. 지금 하던일에 집중하세요!"
          resultMessageSub = "(응원합니다)"
          resultDetail = "나와 같은 별풍력을 가진 BJ : 탱글다희, 유혜디, 로이조, 까루 등 "
          break;
      }
      if (prediction[0].className == '월1억') {

        $('.result-message1').html(resultMessage1);
        $('.resultmessagesub').html(resultMessageSub);
        $('.result-detail').html(resultDetail);
      } else if (prediction[0].className == '월5천') {
        $('.result-message2').html(resultMessage2);
        $('.resultmessagesub').html(resultMessageSub);
        $('.result-detail').html(resultDetail);
      } else if (prediction[0].className == '월3천') {
        $('.result-message3').html(resultMessage3);
        $('.resultmessagesub').html(resultMessageSub);
        $('.result-detail').html(resultDetail);
      } else if (prediction[0].className == '월천') {
        $('.result-message4').html(resultMessage4);
        $('.resultmessagesub').html(resultMessageSub);
        $('.result-detail').html(resultDetail);
      } else if (prediction[0].className == '천이하') {
        $('.result-message5').html(resultMessage5);
        $('.resultmessagesub').html(resultMessageSub);
        $('.result-detail').html(resultDetail);
      }

      for (let i = 0; i < maxPredictions; i++) {
        const classPrediction =
          prediction[i].className + ": " + prediction[i].probability.toFixed(2) * 100 + "%";
        labelContainer.childNodes[i].innerHTML = classPrediction;
      }
    }
  </script>

</body>

</html>